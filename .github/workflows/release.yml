name: Build and Release APK

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Set up .NET
        uses: actions/setup-dotnet@v1
        with:
          dotnet-version: '7.0.x'

      # https://blog.taranissoftware.com/build-net-maui-apps-with-github-actions
      - name: Install MAUI Workload
        run: dotnet workload install maui --ignore-failed-sources
        
      - name: Restore NuGet Packages
        run: dotnet restore

      - name: Build APK
        run: dotnet build -f net7.0-android -c Release

     #- name: Upload APK as Release Asset
     #  uses: actions/upload-artifact@v1
     #  with:
     #    name: app-release
     #    path: YeetMacro2/bin/Release/net7.0-android/com.companyname.yeetmacro2-Signed.apk
      
      # https://github.com/softprops/action-gh-release
      - name: Attach Asset to Release
        uses: softprops/action-gh-release@v1
        tag_name: test_tag
        with:
          files: YeetMacro2/bin/Release/net7.0-android/com.companyname.yeetmacro2-Signed.apk